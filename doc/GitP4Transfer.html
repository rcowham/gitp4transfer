<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<meta name="author" content="Perforce Professional Services">
<title>GitP4Transfer - Git to P4 Migration</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="book">
<div id="header">
<h1>GitP4Transfer - Git to P4 Migration</h1>
<div class="details">
<span id="author" class="author">Perforce Professional Services</span><br>
<span id="email" class="email"><a href="mailto:consulting@perforce.com">consulting@perforce.com</a></span><br>
<span id="revdate">2023-08-01</span>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_gitp4transfer_py">1. GitP4Transfer.py</a>
<ul class="sectlevel2">
<li><a href="#_overview">1.1. Overview</a></li>
<li><a href="#_pre_requisites">1.2. Pre-requisites</a>
<ul class="sectlevel3">
<li><a href="#_install_gitgit_lfs">1.2.1. Install Git/Git LFS</a></li>
<li><a href="#_clone_repo">1.2.2. Clone repo</a></li>
<li><a href="#_fetch_all_lfs_objects">1.2.3. Fetch all LFS objects</a></li>
<li><a href="#_install_python3_8">1.2.4. Install Python3.8</a></li>
<li><a href="#_install_gitp4transfer_py">1.2.5. Install GitP4Transfer.py</a></li>
<li><a href="#_note_about_temp_branch">1.2.6. Note about temp branch</a></li>
<li><a href="#_things_to_do">1.2.7. Things to do</a></li>
<li><a href="#_branch_diffs">1.2.8. Branch diffs</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_gitp4transfer_tool_for_git_and_plastic_scm_migrations">2. gitp4transfer - tool for Git and Plastic SCM migrations</a>
<ul class="sectlevel2">
<li><a href="#_overall_approach">2.1. Overall Approach</a>
<ul class="sectlevel3">
<li><a href="#_resulting_converted_repository_and_how_to_use_it">2.1.1. Resulting converted repository and how to use it</a></li>
</ul>
</li>
<li><a href="#_approach_for_plastic_scm">2.2. Approach for Plastic SCM</a>
<ul class="sectlevel3">
<li><a href="#_creating_plastic_git_export_file">2.2.1. Creating Plastic Git Export file</a></li>
<li><a href="#_exporting_of_data">2.2.2. Exporting of data</a></li>
</ul>
</li>
<li><a href="#_running_gitp4transfer">2.3. Running gitp4transfer</a>
<ul class="sectlevel3">
<li><a href="#_configuration_yaml_file">2.3.1. Configuration YAML file</a></li>
</ul>
</li>
<li><a href="#_using_the_shell_wrapper_run_conversion_sh">2.4. Using the shell wrapper run_conversion.sh</a>
<ul class="sectlevel3">
<li><a href="#_example_conversions">2.4.1. Example conversions</a></li>
</ul>
</li>
<li><a href="#_useful_utilities">2.5. Useful Utilities</a>
<ul class="sectlevel3">
<li><a href="#_gitfilter">2.5.1. gitfilter</a></li>
<li><a href="#_gitgraph">2.5.2. gitgraph</a></li>
</ul>
</li>
<li><a href="#_troubleshooting">2.6. Troubleshooting</a>
<ul class="sectlevel3">
<li><a href="#_verify_errors">2.6.1. Verify Errors</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_gitp4transfer_py">1. GitP4Transfer.py</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview">1.1. Overview</h3>
<div class="paragraph">
<p>This is a functional script to import a git repo with LFS commits for a single branch (e.g. master/main) into Helix Core.</p>
</div>
<div class="paragraph">
<p>It includes some ideas from <code>git-p4</code> and <code>git-filter-repo.py</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_pre_requisites">1.2. Pre-requisites</h3>
<div class="ulist">
<ul>
<li>
<p>Install recent version of git (2.x)</p>
</li>
<li>
<p>Install Python 3.8+ and modules p4python</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_install_gitgit_lfs">1.2.1. Install Git/Git LFS</h4>
<div class="paragraph">
<p>Easiest to install these from Wandisco to get recent versions (need 2.x and not 1.8 for example):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo yum install http://opensource.wandisco.com/centos/7/git/x86_64/wandisco-git-release-7-2.noarch.rpm
sudo yum install git git-lfs
git --version</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_clone_repo">1.2.2. Clone repo</h4>
<div class="paragraph">
<p>This assumes a filesystem such as <code>/hxdepots</code> with plenty of free space.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>cd /hxdepots
mkdir work
cd work
git clone &lt;url of your git repo&gt;</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fetch_all_lfs_objects">1.2.3. Fetch all LFS objects</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>First ensure that git LFS credentials are stored</p>
<div class="literalblock">
<div class="content">
<pre>git config --global credential.helper store</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>$ git branch
* master</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>$ git lfs fetch --all
fetch: 163739 object(s) found, done.
fetch: Fetching all references...
Username for 'https://git.example.com': fred.bloggs
Password for 'https://fred.bloggs@example.com':
Downloading LFS objects:   4% (6561/163738), 9.1 GB | 100 MB/s</pre>
</div>
</div>
</li>
<li>
<p>After the above you can Ctrl+C to abort because credentials should be in place.</p>
<div class="literalblock">
<div class="content">
<pre>cat ~/.git-credentials</pre>
</div>
</div>
</li>
<li>
<p>If you want to check, the re-run the command and you should not be prompted.</p>
<div class="literalblock">
<div class="content">
<pre>git lfs fetch --all</pre>
</div>
</div>
</li>
<li>
<p>Finally you can spawn the full fetch of all LFS versions (which often takes hours depending on size of your repo):</p>
<div class="literalblock">
<div class="content">
<pre>nohup git lfs fetch --all &gt; ../fetch.out &amp;</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>perforce@ip-10-0-0-151 gitrepo]$ cat ../fetch.out
fetch: 163739 object(s) found, done.
fetch: Fetching all references...</pre>
</div>
</div>
</li>
<li>
<p>Check for LFS files not found too - all files less than 140 bytes in size are possible candidates to be checked:</p>
<div class="literalblock">
<div class="content">
<pre>find .git/lfs/objects/ -type f -size -140c</pre>
</div>
</div>
</li>
<li>
<p>LFS files which have not been replaced with their proper contents will be similar to this sort of format:</p>
<div class="literalblock">
<div class="content">
<pre>version https://git-lfs.github.com/spec/v1
oid sha256:8923f38904c1ae21cd3d3e6e93087c07fda86fe97ee01d8664bb95fc20cd1de
size 858449</pre>
</div>
</div>
<div class="paragraph">
<p>If such files are found, you will need to determine why they were not fetched and try to fix that to get proper LFS contents downloaded.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_install_python3_8">1.2.4. Install Python3.8</h4>
<div class="paragraph">
<p>Unfortunately 3.6 is missing some required changes in the <code>subproc</code> library, so you may ßneed to build from source. Ubuntu is similar (but different dependencies to install first!)</p>
</div>
<div class="literalblock">
<div class="content">
<pre>yum install wget yum-utils make gcc openssl-devel bzip2-devel libffi-devel zlib-devel
VER="3.8.12"
wget https://www.python.org/ftp/python/$VER/Python-$VER.tgz
tar zxvf Python-$ver.tgz
cd Python-$ver
./configure
make install</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_install_gitp4transfer_py">1.2.5. Install GitP4Transfer.py</h4>
<div class="paragraph">
<p>We install dependencies and then the script itself.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run the following as <code>root</code>:</p>
<div class="listingblock">
<div class="content">
<pre>cat &lt;&lt; EOF &gt; /etc/yum.repos.d/perforce.repo
[Perforce]
name=Perforce
baseurl=http://package.perforce.com/yum/rhel/7/x86_64/
enabled=1
gpgcheck=1
EOF

rpm --import https://package.perforce.com/perforce.pubkey

yum install perforce-p4python3</pre>
</div>
</div>
</li>
<li>
<p>As normal user, e.g. <code>perforce</code>:</p>
<div class="literalblock">
<div class="content">
<pre>pip3 install --user requests ruamel.yaml</pre>
</div>
</div>
</li>
<li>
<p>Clone the gitp4transfer repo</p>
<div class="literalblock">
<div class="content">
<pre>git clone https://github.com/perforce/gitp4transfer.git</pre>
</div>
</div>
</li>
<li>
<p>Ensure dependencies setup</p>
<div class="literalblock">
<div class="content">
<pre>cd gitp4transfer
python3 GitP4Transfer.py -h</pre>
</div>
</div>
<div class="paragraph">
<p>The above should produce output like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">$ ./GitP4Transfer.py -h
usage: GitP4Transfer.py [-h] [-c CONFIG] [-n] [-m MAXIMUM] [-r] [-s] [--sample-config] [--end-datetime END_DATETIME]

NAME:
    GitP4Transfer.py

DESCRIPTION:
    This python script (3.8+ compatible) will transfer Git changes into a Perforce
    Helix Core Repository, somewhat similar to 'git p4' (not historical) and also
    GitFusion (now deprecated).

    This script transfers changes in one direction - from a source Git server to a
    target p4 server.
    It handles LFS files in the source server (assuming git LFS is suitably installed and enabled)

    Requires Git version 2.7+ due to use of formatting flags

    Usage:

        python3 GitP4Transfer.py -h

    The script requires a config file, by default transfer.yaml. An initial example can be generated, e.g.

        GitP4Transfer.py --sample-config &gt; transfer.yaml

    For full documentation/usage, see project doc:

        https://github.com/rcowham/gitp4transfer/blob/main/doc/GitP4Transfer.adoc

optional arguments:
  -h, --help            show this help message and exit
  -c CONFIG, --config CONFIG
                        Default is transfer.yaml
  -n, --notransfer      Validate config file and setup source/target workspaces but don't transfer anything
  -m MAXIMUM, --maximum MAXIMUM
                        Maximum number of changes to transfer
  -r, --repeat          Repeat transfer in a loop - for continuous transfer as background task
  -s, --stoponerror     Stop on any error even if --repeat has been specified
  --sample-config       Print an example config file and exit
  --end-datetime END_DATETIME
                        Time to stop transfers, format: 'YYYY/MM/DD HH:mm' - useful for automation runs during quiet periods e.g. run overnight but stop first thing in the morning

Copyright (C) 2021-22 Robert Cowham, Perforce Software Ltd</code></pre>
</div>
</div>
</li>
<li>
<p>Setup config file</p>
<div class="literalblock">
<div class="content">
<pre>python3 GitP4Transfer.py --sample-config &gt; transfer_config.yaml</pre>
</div>
</div>
</li>
<li>
<p>Create appropriate target depot, e.g. <code>//git_import/repoA/master</code> and ensure setup in config file.</p>
</li>
<li>
<p>Do a test of config:</p>
<div class="literalblock">
<div class="content">
<pre>python3 GitP4Transfer.py -c transfer_config.yaml -n</pre>
</div>
</div>
<div class="paragraph">
<p>Validate log files for success.</p>
</div>
</li>
<li>
<p>Consider setting up <code>p4 typemap</code> as appropriate for your import (e.g. for Unreal Engine or Unity)</p>
</li>
<li>
<p>Do a first test of one commit (note this is often quite a big commit so may still take a while!)</p>
<div class="literalblock">
<div class="content">
<pre>python3 GitP4Transfer.py -c transfer_config.yaml -m1</pre>
</div>
</div>
</li>
<li>
<p>If the above works, kick off a full transfer and monitor log/output file:</p>
<div class="literalblock">
<div class="content">
<pre>nohup python3 GitP4Transfer.py -c transfer_config.yaml &gt; out &amp;</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_note_about_temp_branch">1.2.6. Note about temp branch</h4>
<div class="paragraph">
<p>The script works by replaying each commit. To do this it executes:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>for each commitid in reverse order:
    git switch -C p4_exportBranch &lt;commitid&gt;
    parse the output of git diff-tree against previous commit
    run various p4 commands</pre>
</div>
</div>
<div class="paragraph">
<p>As a result, expect the new branch <code>p4_exportBranch</code> to be created and continually updated. This is effectively a dummy branch.</p>
</div>
<div class="paragraph">
<p>When the script has finished you may need to: <code>git checkout master</code> or similar to reset to your current branch.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
if the script fails, then the active branch is going to be the temp one - don&#8217;t assume it is HEAD/master!
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_things_to_do">1.2.7. Things to do</h4>
<div class="ulist">
<ul>
<li>
<p>Adjust unknown_git user</p>
</li>
<li>
<p>Date times for changes update</p>
</li>
<li>
<p>Interleave in date/time order</p>
</li>
<li>
<p>More informative commit messages</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_branch_diffs">1.2.8. Branch diffs</h4>
<div class="paragraph">
<p>Generated by:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>git log --first-parent --oneline master &gt; ../b_master.txt</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_gitp4transfer_tool_for_git_and_plastic_scm_migrations">2. gitp4transfer - tool for Git and Plastic SCM migrations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This uses git&#8217;s <code>fast-import</code> (or <code>fast-export</code>) file format which is more or less supported as an export format for Plastic SCM (with caveats below!)</p>
</div>
<div class="paragraph">
<p>These files contain a complete record of the main information from a git repository:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>file contents (blobs) - the actual content of each unique file (e.g. a git SHA1 entry)</p>
</li>
<li>
<p>commits (including attributes such as user/datetime/message etc) and with lists of actions within that commit:</p>
<div class="ulist">
<ul>
<li>
<p>modify (new or edited file)</p>
</li>
<li>
<p>delete (of file or directory)</p>
</li>
<li>
<p>rename (of file or directory)</p>
</li>
<li>
<p>copy (of file or directory)</p>
</li>
</ul>
</div>
</li>
<li>
<p>branch indications (per commit)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The format of these files is documented here: <a href="https://git-scm.com/docs/git-fast-import" class="bare">https://git-scm.com/docs/git-fast-import</a></p>
</div>
<div class="paragraph">
<p>Simple examples are included in the test module: <a href="../main_test.go">main_test.go</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre>blob
mark :1
data 9
contents

blob
mark :2
data 10
contents2

reset refs/heads/main
commit refs/heads/main
mark :3
author Robert Cowham &lt;rcowham@perforce.com&gt; 1680784555 +0100
committer Robert Cowham &lt;rcowham@perforce.com&gt; 1680784555 +0100
data 8
initial
M 100644 :1 src/file1.txt
M 100644 :2 src/file2.txt</pre>
</div>
</div>
<div class="sect2">
<h3 id="_overall_approach">2.1. Overall Approach</h3>
<div class="paragraph">
<p>The <code>gitp4transfer</code> tool can be run on a <code>git fast-export</code> file, and the tool creates:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a <code>p4d</code> journal format (using schema for p4d 2004.2 release)</p>
</li>
<li>
<p>individual librarian files (equivalent of git blobs) in a directory tree corresponding to p4d depot structure</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These are used to create a Perforce Helix Core repository:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>p4d -jr &lt;journal&gt;</code> to create db.* metadata files</p>
</li>
<li>
<p><code>p4d -xu</code> to upgrade the db.* to format of the actual <code>p4d</code> version schema</p>
</li>
<li>
<p><code>p4 storage</code> command is run to perform the 2019.1 <code>p4d</code> storage upgrade process</p>
</li>
<li>
<p><code>p4 verify -qu</code> command is run to perform an update of the MD5 checksums for all depot files</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Optionally:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>p4d -xi</code> can convert the repository to unicode mode</p>
</li>
<li>
<p>you can specify that a case-sensitive Plastic Repository is converted to <code>p4d</code> repository running in "case-insensitive" mode (at the risk of the loss of some actions, e.g. those which only differ in case)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All of the above operations are wrapped by the <code>run_conversion.sh</code> script (<a href="#_using_the_shell_wrapper_run_conversion_sh">Section 2.4, &#8220;Using the shell wrapper run_conversion.sh&#8221;</a>) with its various parameters.</p>
</div>
<div class="sect3">
<h4 id="_resulting_converted_repository_and_how_to_use_it">2.1.1. Resulting converted repository and how to use it</h4>
<div class="paragraph">
<p>The result of a successful repository converted by <code>gitp4transfer</code> contains:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a top level depot with all branches</p>
</li>
<li>
<p>branching is "sparse" meaning that only files changed on actual git branches are populated withint the resultind p4d repo</p>
<div class="ulist">
<ul>
<li>
<p>therefore you will need to review</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Using the result can be done in two main ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>As a standalone p4d repository</p>
</li>
<li>
<p>As a basis for using p4 DVCS commands (p4 push/fetch) to transfer the converted contents into an already existing repository</p>
<div class="ulist">
<ul>
<li>
<p>Note the usual caveats about the requirements for compatible settings for case sensitivity, unicode etc.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_approach_for_plastic_scm">2.2. Approach for Plastic SCM</h3>
<div class="paragraph">
<p>Plastic&#8217;s git export capability writes files which are only directly git-compatible for simple repos. The following issues occur in practice:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>branch names contain spaces (auto-converted to underscores "_")</p>
</li>
<li>
<p>multiple operations in the same commit can over-write each other - especially common when merging commits between branches. Examples include:</p>
<div class="ulist">
<ul>
<li>
<p>modify of a renamed file (so called "dirty rename")</p>
</li>
<li>
<p>delete of the target of a renamed file (which means the rename is not actioned)</p>
</li>
<li>
<p>delete of an already deleted file</p>
</li>
<li>
<p>rename of a renamed file</p>
</li>
<li>
<p>many, many more! These are "documented" as part of the test suite</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The above are complicated by the fact that you can perform actions on a directory (e.g. rename "src" to "targ" which affect all the files current present in that directory "src"). Also a "directory action" such as rename or delete, may override individual file actions which came previously in the same commit! This is especially common when you look at commits which are the result of "merges" from other branches.</p>
</div>
<div class="paragraph">
<p>The net result is a lot of complexity and iterating through all the "file actions" in a commit, trying to decide which ones are still valid, and which are invalid because they have been over-ridden by a later action.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Plastic&#8217;s "creativity" in this area (actions over-riding other actions in same commit) means that there likely to be scenarios still not yet correctly covered by the current tool.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_creating_plastic_git_export_file">2.2.1. Creating Plastic Git Export file</h4>
<div class="paragraph">
<p>Create workspaces:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>cm wk mk SomeRepo /data/work/SomeRepo SomeRepo@some_server@cloud
cd /data/work/SomeRepo</pre>
</div>
</div>
<div class="paragraph">
<p>Show rough stats:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[robert@testhost SomeRepo]$ cm status
/main@SomeRepo@some_server@cloud (cs:49123 - head)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Other details:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[robert@testhost SomeRepo]$ cm find changeset &gt; ../cm_SomeRepo.txt

[robert@testhost Onward2Repo]$ tail -3 ../cm_SomeRepo.txt
1112339  49123    /main/beta/dev/Art 07/07/2022 09:29:51 fred@example.com Update files

Total: 49012</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note the number of the final changelist and the total may not be the same.</p>
</div>
</div>
<div class="sect3">
<h4 id="_exporting_of_data">2.2.2. Exporting of data</h4>
<div class="paragraph">
<p>From within the workspace directory, launch the Plastic <code>cm fast-export</code> command - this creates a complete single git <code>fast-export</code> format file containing all file revisions and all commits.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>nohup cm fast-export --export-marks=marks.cm SomeRepo@some_server@cloud ../git-SomeRepo &gt; ../out_SomeRepo &amp;</pre>
</div>
</div>
<div class="paragraph">
<p>This can take a while (hours), and also can produce rather large export files (e.g. many TB in size!)</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_running_gitp4transfer">2.3. Running gitp4transfer</h3>
<div class="paragraph">
<p>Once you have created the git export, you can run the <code>gitp4transfer</code> tool to process it. While it does work on Windows, it is usually run on Linux (or Mac).</p>
</div>
<div class="paragraph">
<p>The latest release of this tool is available here: <a href="https://github.com/rcowham/gitp4transfer/releases" class="bare">https://github.com/rcowham/gitp4transfer/releases</a></p>
</div>
<div class="paragraph">
<p>Basic help and options are shown below. It is normally expected that you don&#8217;t run the tool directly but use the wrapper script <a href="#_using_the_shell_wrapper_run_conversion_sh">Section 2.4, &#8220;Using the shell wrapper run_conversion.sh&#8221;</a> (which does expect that <code>gitp4transfer</code> is in the $PATH)</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ./gitp4transfer -h
usage: gitp4transfer [&lt;flags&gt;] [&lt;gitimport&gt;]

Parses one or more git fast-export files to create a Perforce Helix Core import

Flags:
  -h, --help                     Show context-sensitive help (also try --help-long and --help-man).
  -c, --config="gitp4transfer.yaml"
                                 Config file for gitp4transfer - allows for branch renaming etc.
  -d, --import.depot="import"    Depot into which to import (overrides config).
      --import.path=IMPORT.PATH  (Optional) path component under import.depot (overrides config).
  -b, --default.branch="main"    Name of default git branch (overrides config).
      --case.insensitive         Create checkpoint case-insensitive mode (for Linux) and lowercase archive files. If not set, then OS default applies.
      --convert.crlf             Convert CRLF in text files to just LF.
      --dummy                    Create dummy (small) archive files - for quick analysis of large repos.
      --dump                     Dump git file, saving the contained archive contents.
  -a, --dump.archives            Saving the contained archive contents if --dump is specified.
  -m, --max.commits=0            Max no of commits to process (default 0 means all).
      --dryrun                   Don't actually create archive files.
      --archive.root=ARCHIVE.ROOT
                                 Archive root dir under which to store extracted archives.
      --graphfile=GRAPHFILE      Graphviz dot file to output git commit/file structure to.
      --journal="jnl.0"          P4D journal file to write (assuming --dump not specified).
      --debug=0                  Enable debugging level.
      --parallel.threads=0       How many parallel threads to use (default 0 means no of CPUs).
      --debug.commit=0           For debugging - to allow breakpoints to be set - only valid if debug &gt; 0.
      --version                  Show application version.

Args:
  [&lt;gitimport&gt;]  Git fast-export file to process.</pre>
</div>
</div>
<div class="sect3">
<h4 id="_configuration_yaml_file">2.3.1. Configuration YAML file</h4>
<div class="paragraph">
<p>This is a fairly simple format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># import_depot: the p4d depot into which all data is imported
import_depot:       import

# import_path: an optional extra path within the import_depot, e.g.
#   "git/repo1" =&gt; //import/git/repo1/&lt;branch&gt;/&lt;git path&gt;
import_path:

# default_branch: the name of the git default branch (typically "main" or "master")
default_branch:     main

# branch_mappings: an array of name/prefix pairs which "rename" the original branches
#   into the p4 repository.
#   Note that the name is a go regex, and the prefix is the equivalent of import_path above
# - name: 	main.*
#   prefix:	trunk
# - name: 	.*
#   prefix:	dev
branch_mappings:

# typemaps: an array of strings representing (simplified) typemap lines.
#   Note type defaults to text+C but various binary formats are correctly
#   detected already, and identified as "binary" or "binary+F"
typemaps:
- binary //....uasset
- binary //....exe</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_the_shell_wrapper_run_conversion_sh">2.4. Using the shell wrapper run_conversion.sh</h3>
<div class="paragraph">
<p>This is <a href="../run_conversion.sh">a Bash script</a> which provides a convenient wrapper to perform conversions and subsequent repository building actions automatically.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ bash ./run_conversion.sh -h
USAGE for run_conversion.sh:

run_conversion.sh &lt;git_fast_export&gt; [-p &lt;P4Root&gt;] [-d] [-c &lt;configfile&gt;] [-dummy] [-crlf] [ [-insensitive] | [-sensitive] ]
    [-depot &lt;import depot&gt;] [-graph &lt;graphFile&gt;] [-m &lt;max commits&gt;] [-t &lt;parallel threads&gt;]

   or

run_conversion.sh -h

    -c           &lt;configfile&gt; name of Yaml config file to control conversion (means parameters below don't need to be provided)
    -d           Debug
    -depot       &lt;import depot&gt; - Depot to use for this import (default is 'import')
    -crlf        Convert CRLF to just LF for text files - useful for importing Plastic Windows exports to a Linux p4d
    -unicode     Create a unicode enabled p4d repository (runs p4d -xi)
    -dummy       Create dummy archives as placeholders (no real content) - much faster
    -graph       &lt;graphfile.dot&gt; Create Graphviz output showing commit structure (see also 'gitgraph' utility which is more flexible)
    -insensitive Specify case insensitive checkpoint (and lowercase archive files) - for Linux servers
    -sensitive   Specify case sensitive checkpoint and restore - for Mac/Windows servers (for testing only)
    -m           &lt;max commits&gt; - Max no of commits to process (stops after this number is reached)
    -t           &lt;parallel threads&gt; - No of parallel threads to use (default is No of CPUs)
    -p          &lt;P4Root&gt; - directory to use as resulting P4Root - will default to a tmp dir if not set
    &lt;git_fast_export&gt; The (input) git fast-export format file (required)

Examples:

./run_conversion.sh export.git
./run_conversion.sh export.git -p P4Root

nohup ./run_conversion.sh export.git -p P4Root -d -c config.yaml &gt; out1 &amp;</pre>
</div>
</div>
<div class="sect3">
<h4 id="_example_conversions">2.4.1. Example conversions</h4>
<div class="paragraph">
<p>Typical conversion process is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Run <code>run_conversion.sh</code> in the background (can take hours) on an export file</p>
</li>
<li>
<p>Review output, concentrating particularly on:</p>
<div class="ulist">
<ul>
<li>
<p>Any verify errors (indicates some sort of logic error in <code>gitp4transfer</code>)</p>
</li>
<li>
<p>Run <code>p4</code> commands against the created <code>p4d</code> instance to review output</p>
</li>
<li>
<p>Run a <code>p4d</code> in the output directory and then use <code>P4V</code> to review the output</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Once things are looking reasonable, you need to test the resulting conversion. E.g.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use Plastic <code>cm</code> to create a workspace with latest known state (on a specific branch)</p>
</li>
<li>
<p>Create a <code>p4</code> workspace for the resulting conversion (same branch), e.g. with root <code>/data/work/p4ws</code></p>
</li>
<li>
<p>Sync the workspace</p>
</li>
<li>
<p>Run a local diff between the two and look to understand any differences in file contents, e.g.</p>
<div class="ulist">
<ul>
<li>
<p><code>diff -qr /data/work/p4ws /data/work/SomeRepo</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that sometimes it is easier to "fix forwards" if there are only a few errors, by manually copying those files over and submitting them.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_useful_utilities">2.5. Useful Utilities</h3>
<div class="paragraph">
<p>These are useful tools which help to understand the repository structure, debug issues with the conversion,
and to test things like resulting p4 structure without worrying about
the contents of all files (because processing of all file contents can take many hours vs a few minutes for filtered views)</p>
</div>
<div class="sect3">
<h4 id="_gitfilter">2.5.1. gitfilter</h4>
<div class="paragraph">
<p>This tool allows you to process a git fast-export file and produce a new version which filters out the actual file contents. Instead it replaces the contents of every <code>blob</code> file with its unique ID.</p>
</div>
<div class="paragraph">
<p>The advantages of this utility are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>resulting git export file is hugely smaller (e.g. TB &#8594; a few GB) and can be processed much quicker</p>
</li>
<li>
<p>it has options to produce a filtered export file which only includes file actions matching specific regex patterns (allows for even more hugely reduced export files and thus enables interactive debugging of problems which might otherwise)</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ./gitfilter -h
usage: gitfilter [&lt;flags&gt;] [&lt;gitimport&gt;] [&lt;gitexport&gt;]

Parses one or more git fast-export files to filter blob contents and write a new one

Flags:
  -h, --help                     Show context-sensitive help (also try --help-long and --help-man).
  -r, --rename                   Rename branches (remove spaces).
  -f, --filter.commits           Filter out empty commits (if --path.filter defined).
  -m, --max.commits=MAX.COMMITS  Max no of commits to process.
      --path.filter=PATH.FILTER  Regex git path to filter output by.
  -d, --debug=DEBUG              Enable debugging level.
      --debug.commit=0           For debugging - to allow breakpoints to be set - only valid if debug &gt; 0.
      --version                  Show application version.

Args:
  [&lt;gitimport&gt;]  Git fast-export file to process.
  [&lt;gitexport&gt;]  Git fast-import file to write.</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Examples</div>
<div class="content">
<pre># Filter a file with debug output
nohup ./gitfilter --debug 1 --rename big_file.git filtered_file.git &gt; out1 &amp;

# Same as above with only 500 commits
nohup ./gitfilter --debug 1 --rename --max.commits 500 big_file.git filtered_file.git &gt; out1 &amp;

# Filter with all file history ommitted except for specified regex paths
nohup ./gitfilter --debug 1 --rename --path.filter "file1/.txt|file2\.txt" big_file.git filtered_file.git &gt; out1 &amp;</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_gitgraph">2.5.2. gitgraph</h4>
<div class="paragraph">
<p>This utility produces Graphviz <code>*.dot</code> files which can create a graphical view (e.g. .svg which can be opened in a browswer) of the git commit structure.</p>
</div>
<div class="paragraph">
<p>While a graph.dot which contains 50k nodes is not easily processed by Graphviz in any sensible amount of time (think hours), with the filtering options (specifying start and end commits) and using a file which has been output from <a href="#_gitfilter">Section 2.5.1, &#8220;gitfilter&#8221;</a> you can create a quick visual representation of the git branching structure and see things like merges between branches etc.</p>
</div>
<div class="paragraph">
<p>Very useful for some debugging/understanding of branching relationships.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ./gitgraph -h
usage: gitgraph [&lt;flags&gt;] [&lt;gitexport&gt;]

Parses one or more git fast-export files to create a graphviz DOT file

Flags:
  -h, --help            Show context-sensitive help (also try --help-long and --help-man).
  -m, --max.commits=0   Max no of commits to process (default 0 means all).
  -o, --output=OUTPUT   Graphviz dot file to output git commit/file structure to.
  -f, --first.commit=0  ID of first commit to include in graph output (default 0 means all commits).
  -l, --last.commit=0   ID of last commit to include in graph output (default of 0 means all commits).
  -s, --squash          Squash commits (leaving branches/merges only).
      --debug=0         Enable debugging level.
      --version         Show application version.

Args:
  [&lt;gitexport&gt;]  Git fast-export file to process.</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example usage</div>
<div class="content">
<pre># Graph first 500 commits
./gitgraph --max.commits 500 --output graph.dot export.git

# Graph commits between start and end, ommitting any commits without either parent or merge
./gitgraph --first.commit 10234 --last.commit 21321 --output graph.dot export.git

# For the above you can create SVG files which can be opened with any browser
# Install Graphviz dot as per your operating system

dot -Tsvg graph.dot &gt; graph.svg</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_troubleshooting">2.6. Troubleshooting</h3>
<div class="sect3">
<h4 id="_verify_errors">2.6.1. Verify Errors</h4>
<div class="paragraph">
<p>If the resulting conversion contains verify errors, then it implies a logic error in the tool which is not coping with
some not previously encountered Plastic/git scenario.</p>
</div>
<div class="paragraph">
<p>The resolution is to consult with the author of the tool:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a log file with debug on</p>
</li>
<li>
<p>Consider providing a <code>gitfilter</code> produced git export (contains filenames but no data)</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2023-08-24 16:27:41 +0100
</div>
</div>
</body>
</html>